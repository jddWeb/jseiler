{namespace f=TYPO3\CMS\Fluid\ViewHelpers}
<!-- HERO TEMPLATE LOADED (safe-visible v3) -->

<f:variable name="slidesCount" value="{f:count(subject: data.slides)}" />

<section class="c-hero js-hero" data-hero aria-roledescription="carousel">
    <!-- Sichtbarkeit erzwingen, bis SCSS greift -->
    <div class="c-hero__viewport" data-hero-viewport style="min-height:60vh;">
        <ul class="c-hero__slides" role="list">

            <f:if condition="{slidesCount} > 0">
                <f:for each="{data.slides}" as="slide" iteration="it">
                    <f:variable name="bg" value="{f:if(condition: slide.image.0, then: slide.image.0, else: slide.image)}" />
                    <f:variable name="overlayClass" value="{f:if(condition: slide.overlayStrength, then: ' c-hero__slide--overlay-' + slide.overlayStrength, else: ' c-hero__slide--overlay-medium')}" />

                    <li class="c-hero__slide{f:if(condition: it.isFirst, then:' is-active')}{overlayClass}"
                        role="group" aria-roledescription="slide" aria-label="{it.cycle} / {it.total}">
                        <div class="c-hero__bg"
                             style="background-image:url('{f:uri.image(image:bg, cropVariant:\'hero\', maxWidth:2400)}');"></div>

                        <div class="c-hero__overlay">
                            <div class="c-hero__inner">
                                <f:if condition="{it.isFirst}">
                                    <f:then><h1 class="c-hero__title">{slide.title}</h1></f:then>
                                    <f:else><h2 class="c-hero__title">{slide.title}</h2></f:else>
                                </f:if>

                                <f:if condition="{slide.text}">
                                    <div class="c-hero__text">{slide.text -> f:format.html()}</div>
                                </f:if>

                                <f:if condition="{slide.ctaLabel}">
                                    <f:link.typolink parameter="{slide.ctaLink}" class="c-hero__cta">
                                        <span class="c-hero__cta-label">{slide.ctaLabel}</span>
                                        <svg class="c-hero__cta-icon" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                                            <path d="M13.172 12l-4.95-4.95 1.414-1.414L16 12l-6.364 6.364-1.414-1.414z"/>
                                        </svg>
                                    </f:link.typolink>
                                </f:if>
                            </div>
                        </div>
                    </li>
                </f:for>
            </f:if>

            <f:if condition="{slidesCount} == 0">
                <li class="c-hero__slide is-active c-hero__slide--overlay-medium" role="group" aria-roledescription="slide" aria-label="1 / 1">
                    <div class="c-hero__bg" style="background-image:linear-gradient(135deg,#dfe8ff 0%,#f3f7ff 40%,#ffffff 100%);"></div>
                    <div class="c-hero__overlay">
                        <div class="c-hero__inner">
                            <h1 class="c-hero__title">Hero-Slider</h1>
                            <div class="c-hero__text">
                                Es sind noch keine Slides gepflegt. Lege bis zu drei Slides an
                                (Titel, Text, CTA, Bild mit Crop-Variante <code>hero</code>).
                            </div>
                        </div>
                    </div>
                </li>
            </f:if>

        </ul>
    </div>

    <!-- Pfeile (außerhalb des Overlays) -->
    <button class="c-hero__nav c-hero__nav--prev" type="button" aria-label="Vorheriger Slide" data-hero-prev></button>
    <button class="c-hero__nav c-hero__nav--next" type="button" aria-label="Nächster Slide" data-hero-next></button>
</section>
