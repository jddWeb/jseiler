<f:comment>HERO TEMPLATE LOADED (fixed spacing + correct CTA link)</f:comment>

<section class="c-hero js-hero"
         data-hero
         aria-roledescription="carousel"
         data-hero-autoplay="{f:if(condition: data.autoplay, then: '1', else: '0')}"
         data-hero-interval="{f:if(condition: data.interval, then: data.interval, else: 6000)}">

    <div class="c-hero__viewport" data-hero-viewport>
        <ul class="c-hero__slides" role="list">

            <f:for each="{data.slides}" as="slide" iteration="it">

                <!-- Overlay-Modifier robust (Select kann String ODER Objekt sein) -->
                <f:variable name="overlayMod" value="{slide.overlayStrength}" />
                <f:if condition="{slide.overlayStrength.value}">
                    <f:then>
                        <f:variable name="overlayMod" value="{slide.overlayStrength.value}" />
                    </f:then>
                </f:if>

                <!-- Hintergrund-URL robust ermitteln -->
                <f:variable name="bgUrl" value="" />
                <f:if condition="{slide.image.publicUrl}">
                    <f:then>
                        <f:variable name="bgUrl" value="{slide.image.publicUrl}" />
                    </f:then>
                    <f:else>
                        <f:if condition="{slide.image.0.publicUrl}">
                            <f:then>
                                <f:variable name="bgUrl" value="{slide.image.0.publicUrl}" />
                            </f:then>
                            <f:else>
                                <f:if condition="{slide.image.0.uid}">
                                    <f:then>
                                        <f:variable name="bgUrl"
                                                    value="{f:uri.image(src: slide.image.0.uid, treatIdAsReference: 1, cropVariant: 'hero')}" />
                                    </f:then>
                                </f:if>
                            </f:else>
                        </f:if>
                    </f:else>
                </f:if>

                <li class="c-hero__slide{f:if(condition: it.isFirst, then: ' is-active')}{f:if(condition: overlayMod, then: ' c-hero__slide--overlay-')}{overlayMod}"
                    role="group"
                    aria-roledescription="slide"
                    aria-label="{it.cycle} / {it.total}">

                    <f:if condition="{bgUrl}">
                        <div class="c-hero__bg" style="background-image:url('{bgUrl}');"></div>
                    </f:if>

                    <div class="c-hero__overlay">
                        <div class="c-hero__inner">
                            <f:if condition="{it.isFirst}">
                                <f:then>
                                    <h1 class="c-hero__title">{slide.title}</h1>
                                </f:then>
                                <f:else>
                                    <h2 class="c-hero__title">{slide.title}</h2>
                                </f:else>
                            </f:if>

                            <f:if condition="{slide.text}">
                                <div class="c-hero__text">{slide.text -> f:format.raw()}</div>
                            </f:if>

                            <f:if condition="{slide.ctaLabel}">
                                <!-- Korrekt: typolink als Tag, nicht als href-String -->
                                <f:link.typolink parameter="{slide.ctaLink}" class="c-hero__cta">
                                    <span class="c-hero__cta-label">{slide.ctaLabel}</span>
                                    <svg class="c-hero__cta-icon" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                                        <path d="M13.172 12l-4.95-4.95 1.414-1.414L16 12l-6.364 6.364-1.414-1.414z"/>
                                    </svg>
                                </f:link.typolink>
                            </f:if>
                        </div>
                    </div>
                </li>
            </f:for>
        </ul>
    </div>

    <!-- Pfeile -->
    <button class="c-hero__nav c-hero__nav--prev" type="button" aria-label="Vorheriger Slide" data-hero-prev tabindex="0"></button>
    <button class="c-hero__nav c-hero__nav--next" type="button" aria-label="NÃ¤chster Slide" data-hero-next tabindex="0"></button>
</section>
